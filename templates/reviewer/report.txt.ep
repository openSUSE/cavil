% use Mojo::Util qw(humanize_bytes);

# Legal Report

Package:  <%== $package->{name} %>
Checkout: <%== $package->{checkout_dir} %>
% my $num_files = $package->{unpacked_files};
% my $size = humanize_bytes($package->{unpacked_size} // 0);
Unpacked: <%== $num_files %> <%== $num_files == 1 ? 'file' : 'files' %> (<%= $size %>)



% if (my $notice = $package->{notice}) {
## System Notice

%== $package->{notice}



% }
## Licenses
% if ($report->{incompatible_licenses} && @{$report->{incompatible_licenses}}) {

% my $licenses = join(', ', map { @{$_->{licenses}} } @{$report->{incompatible_licenses}});
**Warning** Elevated risk, package might contain incompatible licenses: <%= $licenses %>

% }
% if (@{$report->{missed_files}}) {

Note: Report is incomplete, reviewers need to create new license patterns for unmatched keywords or ignore false
positive matches. Estimated risks for each file are based on the highest risk snippet. The lower its similarity to
existing license patterns, the higher the risk will climb above the predicted license.


### Risk 9 (Unknown)

%   for my $file (@{$report->{missed_files}}) {
%     my $license = $file->{spdx} || $file->{license};
* `<%== $file->{name} %>`: <%== $file->{match} %>% similarity to "<%== $license %>", estimated risk <%== $file->{max_risk} %>
%   }

% }
% my $risks = $report->{risks};
% for my $risk (reverse sort keys %$risks) {
%   my $current = $risks->{$risk};

### Risk <%== $risk %> (<%== $risk <= 3 ? 'Low' : $risk == 4 ? 'Medium' : 'High'%>)

%   for my $lic (sort keys %$current) {
%     my $matches = $current->{$lic};
%     my $num = scalar @{$matches->{files}};
* <%== $matches->{spdx} || $matches->{name} %>: <%== $num %> <%== $num == 1 ? 'file' : 'files' %>
%   }


% }
% if (!(keys %{$report->{risks}}) && !@{$report->{missed_files}}) {

No files matching any known license patterns or keywords have been found.


% }

## About

This plain text report was generated by Cavil. For more details please consult the HTML and SPDX reports.
