{"license":"CPL-1.0","opinion":0,"packname":"trousers","patent":0,"pattern":"free software; you can redistribute it and\/or modify\n * it under the terms of the Common Public License as published by\n * IBM Corporation; either version 1 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * Common Public License for more details.\n *\n * You should have received a copy of the Common Public License\n * along with this program; if not, a copy can be viewed at\n * http:\/\/www.opensource.org\/licenses\/cpl1.0.php.\n *\n * trousers - An open source TCG Software Stack\n *\n * Author: james.xu@intel.com Rossey.liu@intel.com\n *\n * Kent Yoder - updates for new authsession mechanism\n * (C) International Business Machines Corp. 2007\n *\n *\/\n\n#include <stdlib.h>\n#include <stdio.h>\n#include <string.h>\n#include <inttypes.h>\n\n#include \"trousers\/tss.h\"\n#include \"trousers\/trousers.h\"\n#include \"trousers_types.h\"\n#include \"trousers_types.h\"\n#include \"spi_utils.h\"\n#include \"capabilities.h\"\n#include \"tsplog.h\"\n#include \"obj.h\"\n#include \"authsess.h\"\n\nTSS_RESULT\nTspi_NV_DefineSpace(TSS_HNVSTORE hNvstore,\t\/* in *\/\n\t\t    TSS_HPCRS hReadPcrComposite,\t\/* in, may be NULL *\/\n\t\t    TSS_HPCRS hWritePcrComposite)\t\/* in, may be NULL*\/\n{\n\tTSS_HCONTEXT  tspContext;\n\tTSS_HTPM hTpm;\n\tTSS_RESULT result;\n\tUINT32 uiResultLen;\n\tBYTE *pResult;\n\tUINT32 i;\n\n\tTPM_BOOL defined_index = FALSE;\n\tNV_DATA_PUBLIC nv_data_public;\n\tTSS_BOOL need_authdata = FALSE;\n\tTCPA_DIGEST digest;\n\tBYTE *pReadPCR;\n\tUINT32 pReadPCR_len;\n\tBYTE *pWritePCR;\n\tUINT32 pWritePCR_len;\n\tUINT64 NVPublic_DataSize;\n\tBYTE NVPublicData[MAX_PUBLIC_DATA_SIZE];\n\tTrspi_HashCtx hashCtx","risk":4,"trademark":0,"unique_id":"fadadbe7-575b-49f2-acd1-7d454e1134b5"}